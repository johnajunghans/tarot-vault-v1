*This document contains specifications for the MVP and an ordered list of stages for building the MVP. When updating this document, use strikethrough (~~complete~~) to indicate completion of a step or entire plan topic.*
# 0_Specifications
*Project information, useful links, and change log*
## 0.1_Tech Stack
### 0.1.1_initial package.json file
```json
{
	"name": "tarot-vault-v1",
	"version": "0.1.0",
	"private": true,
	"scripts": {
		"dev": "npm-run-all --parallel dev:frontend dev:backend",
		"dev:frontend": "next dev",
		"dev:backend": "convex dev",
		"predev": "convex dev --until-success && convex dashboard",
		"build": "next build",
		"start": "next start",
		"lint": "eslint ."
	},
	"dependencies": {
		"@base-ui/react": "^1.1.0",
		"@clerk/clerk-react": "^5.60.0",
		"@clerk/nextjs": "^6.37.1",
		"class-variance-authority": "^0.7.1",
		"clsx": "^2.1.1",
		"convex": "^1.31.7",
		"hugeicons-react": "^0.4.0",
		"next": "^16.1.6",
		"react": "^19.2.4",
		"react-dom": "^19.2.4",
		"tailwind-merge": "^3.4.0"
	},
	"devDependencies": {
		"@convex-dev/eslint-plugin": "^1.1.1",
		"@tailwindcss/postcss": "^4.1.18",
		"@types/node": "^24.10.9",
		"@types/react": "^19.2.10",
		"@types/react-dom": "^19.2.3",
		"eslint": "^9.39.2",
		"eslint-config-next": "^16.1.6",
		"npm-run-all2": "^8.0.4",
		"prettier": "^3.8.1",
		"tailwindcss": "^4.1.18",
		"tw-animate-css": "^1.4.0",
		"typescript": "^5.9.3"
	}
}
```
### 0.1.2_Core
- React + NextJS
- TypeScript
### 0.1.3_Frontend
### 0.1.4_Backend
#### 0.1.4.1_Database
- Convex
#### 0.1.4.2_Authentication
- Clerk
#### 0.1.4.3_Server
- Vercel
## 0.2_Details
### 0.2.1_Frontend
#### 0.2.1.1_Shadcn
##### 0.2.1.1.1_initial components.json file

```json
{
	"$schema": "https://ui.shadcn.com/schema.json",
	"style": "base-nova",
	"rsc": true,
	"tsx": true,
	"tailwind": {
		"config": "",
		"css": "app/globals.css",
		"baseColor": "stone",
		"cssVariables": true,
		"prefix": ""
	},
	"iconLibrary": "hugeicons",
	"rtl": false,
	"aliases": {
		"components": "@/components",
		"utils": "@/lib/utils",
		"ui": "@/components/ui",
		"lib": "@/lib",
		"hooks": "@/hooks"
	},
	"registries": {}
}
```
##### 0.2.1.1.2_expected components
- Avatar
- Badge
- Breadcrumb
- Button
- Button Group
- Calendar
- Card
- Collapsable
- Date Picker
- Dialog
- Dropdown Menu
- Empty
- Field
- Input
- Label
- Popover
- Progress
- Radio Group
- Resizable
- Scroll Area
- Select
- Separator
- Sidebar
- Skeleton
- Sonner
- Spinner
- Switch
- Tabs
- Toggle
- Toggle Group
- Tooltip
#### 0.2.1.2_Forms
- react-hook-form + zod
	- Use in combination with shadcn/ui Field component to build forms
#### 0.2.1.3_Dark Mode
- next-themes
	- As outlined in shadcn/ui for use with nextjs
### 0.2.2_Backend
#### 0.2.2.1_Convex
##### 0.2.2.1.1_Tables
###### 0.2.2.1.1.1_users
**Properties**
- _id: users._id
- authId: string (id generated by Clerk)
- tokenIdentifier: string 
- createdAt: string
- updatedAt: string
- lastSignedIn: string
- name: string
- email: string
- settings: object
	- appearance: object
		- theme: "light" | "dark" | "system" (default = "system")
	- preferences: object
		- useReverseMeanings: "auto" | "always" | "never" (default = "auto")
	- notifications: object
		- private: object
			- showToasts: boolean (default = true) *whether to show toasts on crud operations*
###### 0.2.2.1.1.2_readings
**Custom Card Type**
- Card: object
	- id: number (integer between 0 and 77)
	- position?: number (integer between 1 and 78)
	- reversed: boolean
	- notes: string

**Properties**
- _id: readings._id
- userId: users._id
- createdAt: string
- updatedAt: string
- question: string
- date: string
- drawMethod: “manual” | “digital”
- digitalDrawRandomness?: “pseudo” | “real” (user just needs a deck of playing cards and a 6 sided die to generate truly random values for card draws)
- spread: object
    - id: spreads._id
    - version: number (between 0 and 77)
- useReverseMeanings: boolean
- useSignifierCard: boolean
- results: object
    - signifier?: Card
    - cards: Card Array
- title?: string
- context?: string
- image?: _storage._id
- parent?: object
    - type: “reading”
    - id: readings._id
- notes?: string
- interpretations?: interpretations._id Array
- starred: boolean (default = false)

**Indexes**
###### 0.2.2.1.1.3_interpretations
**Properties**
- _id: interpretations._id
- userId: users._id
- readingId: readings._id (foreign key - one to many: readings can have many interpretations)
- createdAt: string
- updatedAt: string
- content: string
- source: “self” | “ai”
- focus?: string
- aiMetadata: object
    - tier: “free” | “premium”
    - model: object
        - name: string
        - version: string
    - requestTime: string
    - totalCost: number
    - tokensUsed: number
    - systemPrompt?: string
**Indexes**
###### 0.2.2.1.1.4_spreads
**Properties**
- _id: spreads._id
- userId: users._id
- createdAt: string
- updatedAt: string
- name: string
- description?: string
- numberOfCards: number (integer between 1 and 78)
- positions: objectArray
    - name: string
    - description?: string
    - transform: object
        - x: number
        - y: number
        - r: number
        - z: number
**Indexes**
## 0.3_Resources
- [Convex: NextJS+Convex Quickstart](https://docs.convex.dev/quickstart/nextjs)
- [Convex: NextJS+Convex Docs](https://docs.convex.dev/client/nextjs/app-router/)
- [Convex: NextJS+Convex+Clerk Setup](https://docs.convex.dev/auth/clerk#nextjs)
- [Clerk: Convex+Clerk Setup](https://clerk.com/docs/guides/development/integrations/databases/convex)
- [Shadcn: next-themes darkmode setup](https://ui.shadcn.com/docs/dark-mode/next)
- [Convex: storing users in the convex database](https://docs.convex.dev/auth/database-auth)
## 0.4_Git
*Protocol for git version control*
### 0.4.1_Repo Info
- url: https://github.com/johnajunghans/tarot-vault-v1
- license: none
- readme: none
## 0.5_Change Log
*This is a space to track all updates.*
### 0.5.1_Example Entry

**02/02/2026 (date) -- 0.5.1 (step) -- Claude 4.5 Sonnet (model)**
Summary of actions taken (be as concise as possible):
- Action 1 
- Action 2
	- Sub-action 1
	- Sub-action 2
- Action 3

Future considerations/recommendations/warnings (Anything at all to consider about this topic moving forward)
- Future consideration/recommendation/warning 1
- Future consideration/recommendation/warning 2
- Future consideration/recommendation/warning 3
### 0.5.2_Entries
*Ordered with most recent at the top*

# 1_Build Plan
## 1.1_Database & Auth Setup
### 1.1.1_Create Database Tables
1. Create the database tables (found in 0.2.2.1.1) in /convex/schema.ts
2. Create indexes for all tables
3. Update 0.2.2.1.1 to include index specifications for all tables
### 1.1.2_Create Webhook to Sync Clerk with Users table
1. Follow guide located [here](https://docs.convex.dev/auth/database-auth#set-up-webhooks) to create /convex/users.ts file and /convex/http.ts file
	1. Note: webhook has already been configured in Clerk with signing secret added as env variable to Convex
2. Scan project and make recommendations for further updates and improvements to the authentication structure.
### 1.1.3_Create database table functions
1. Create files in /convex for each table (apart from users.ts which should already exist):
	1. /convex/readings.ts
	2. /convex/interpretations.ts
	3. /convex/spreads.ts
2. Within each file, create query and mutation functions (*Note: check to ensure that indexes are correct for handling all functions*)
	1. All tables should have the following functions:
		1. get documents (max 10)
			1. should be ordered by 'updatedAt' property so most recently updated comes first
		2. create/insert document
		3. update document
		4. delete document
	2. Then certain tables should have extra functions:
		1. readings
			1. get starred readings (i.e. readings with property 'starred' = true)
		2. spreads
			1. get specific spread given id
		3. interpretations
			1. get interpretations by 'readingId' (foreign key)
			2. get interpretations by 'source' (either 'self' or 'ai')
## 1.2_Frontend Setup






