---
description: Tarot Vault project structure, tech stack, and architecture overview
alwaysApply: true
---

# Tarot Vault v1 - Project Structure

## Overview

Tarot Vault is a full-stack tarot reading application built with Next.js, Convex, and Clerk. It allows users to create, store, and interpret tarot readings with AI assistance.

## Tech Stack

### Core
- **Framework**: Next.js 16 (App Router)
- **Language**: TypeScript
- **React**: 19.2.4

### Backend
- **Database**: Convex (real-time database with server functions)
- **Authentication**: Clerk
- **Hosting**: Vercel (planned)

### Frontend
- **UI Library**: shadcn/ui (base-nova style)
- **Styling**: Tailwind CSS 4
- **Icons**: hugeicons-react
- **Fonts**: Philosopher (main), Geist Mono (code)

### Development
- **Package Manager**: npm
- **Linting**: ESLint with Convex plugin
- **Formatting**: Prettier

## Project Structure

```
/
├── app/                    # Next.js App Router pages
│   ├── layout.tsx         # Root layout with Clerk & Convex providers
│   ├── page.tsx           # Landing page (auth required)
│   ├── app/               # Main app routes
│   │   ├── layout.tsx     # App layout with sidebar
│   │   ├── page.tsx       # App home
│   │   └── personal/      # Personal workspace routes
│   │       └── page.tsx
│   └── server/            # Server-side rendering examples
│       └── page.tsx
├── components/
│   ├── app/               # App-specific components
│   │   └── app-sidebar.tsx  # Main navigation sidebar
│   ├── ui/                # shadcn/ui components
│   │   ├── button.tsx
│   │   ├── input.tsx
│   │   ├── sidebar.tsx
│   │   └── ...
│   └── ConvexClientProvider.tsx  # Convex + Clerk integration
├── convex/                # Convex backend
│   ├── _generated/        # Auto-generated types and API
│   ├── auth.config.ts     # Clerk JWT configuration
│   ├── schema.ts          # Database schema definitions
│   ├── myFunctions.ts     # Example functions (to be replaced)
│   └── README.md
├── hooks/                 # React hooks
│   └── use-mobile.ts
├── lib/                   # Utilities
│   └── utils.ts           # cn() helper for Tailwind
├── public/                # Static assets
│   └── convex.svg
├── .cursor/rules/         # Cursor AI rules
│   ├── convex_rules.mdc
│   └── mvp-build-protocl.mdc
├── mvp-build.md          # MVP specifications and build plan
├── components.json       # shadcn/ui configuration
├── package.json
└── tsconfig.json
```

## Database Schema (Planned)

### Tables

#### users
- `_id`: users._id
- `authId`: string (Clerk ID)
- `tokenIdentifier`: string
- `createdAt`, `updatedAt`, `lastSignedIn`: string
- `name`, `email`: string
- `settings`: object (theme, preferences, notifications)

#### readings
- `_id`: readings._id
- `userId`: users._id
- `question`: string
- `date`: string
- `drawMethod`: "manual" | "digital"
- `spread`: { id: spreads._id, version: number }
- `useReverseMeanings`: boolean
- `results`: { signifier?: Card, cards: Card[] }
- `starred`: boolean
- Optional: `title`, `context`, `image`, `parent`, `notes`, `interpretations`

#### interpretations
- `_id`: interpretations._id
- `userId`: users._id
- `readingId`: readings._id
- `content`: string
- `source`: "self" | "ai"
- `aiMetadata`: object (tier, model, costs)

#### spreads
- `_id`: spreads._id
- `userId`: users._id
- `name`: string
- `numberOfCards`: number (1-78)
- `positions`: array of { name, description, transform }

### Custom Types

**Card Object**:
```typescript
{
  id: number,        // 0-77
  position?: number, // 1-78
  reversed: boolean,
  notes: string
}
```

## Key Conventions

### Routing
- Landing page: `/` (requires auth)
- App routes: `/app/*`
- Personal workspace: `/app/personal/*`
- Server examples: `/server/*`

### Path Aliases
- `@/components` → `./components`
- `@/lib` → `./lib`
- `@/hooks` → `./hooks`
- `@/ui` → `./components/ui`

### Convex Integration
- Use `api` from `convex/_generated/api` for public functions
- Use `internal` for internal functions
- Follow Convex function syntax with args/returns validators
- See `.cursor/rules/convex_rules.mdc` for detailed guidelines

### Authentication
- Clerk provides auth with `<ClerkProvider>` in root layout
- Convex integrates via `ConvexProviderWithClerk`
- Use `<Authenticated>` and `<Unauthenticated>` components
- JWT issuer domain configured in `convex/auth.config.ts`

### Styling
- Tailwind CSS 4 with custom configuration
- shadcn/ui base-nova style with stone base color
- CSS variables enabled for theming
- Dark mode support via next-themes (planned)

### Scripts
- `npm run dev`: Start both frontend (Next.js) and backend (Convex)
- `npm run dev:frontend`: Next.js dev server only
- `npm run dev:backend`: Convex dev server only
- `npm run build`: Production build
- `npm run lint`: ESLint check

## Development Status

**Current Phase**: Database & Auth Setup (Stage 1.1)

**Completed**:
- Initial project scaffolding
- Clerk authentication setup
- Basic UI components (sidebar, buttons, etc.)
- Convex integration

**In Progress**:
- Database schema implementation
- Webhook for Clerk → Convex user sync
- CRUD functions for all tables

**Planned**:
- Frontend UI for readings, spreads, interpretations
- AI interpretation generation
- Dark mode
- Forms with react-hook-form + zod

## Important Files

- `mvp-build.md`: Complete MVP specifications and build plan
- `.cursor/rules/convex_rules.mdc`: Convex coding guidelines
- `components.json`: shadcn/ui configuration
- `convex/schema.ts`: Database schema (currently placeholder)

## Resources

- [Convex Docs](https://docs.convex.dev/)
- [Next.js App Router](https://nextjs.org/docs/app)
- [Clerk + Convex Setup](https://docs.convex.dev/auth/clerk)
- [shadcn/ui](https://ui.shadcn.com/)
